<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>shellcode development - lab02 - escobarflughafen</title>
  <meta name="description" content="This is an example site description. You can use Markdown here.">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="icon" href="/assets/img/home.png" type="image/x-icon">
</head>
<body class="mb-3">


<header class="header-banner line-overlay">
    <div class="container">
        <div class="row header-banner-row px-3">
            <a href="/" class="col-auto subway-red link-no-effect pe-3">
                <h1 class="head-text display-text">
                    Exit
                </h1>
            </a>
            <!--prev post-->


            <div class="col flex-grow-1 pe-3">
                <h1 class="head-text">
                    shellcode development - lab02
                </h1>
            </div>


            <a class="col-auto subway-blue link-no-effect" href="#toc">
                <h1 class="head-text display-text">
                   Toc
                </h1>
            </a>

            <div class="col-12 col-md px-0">
                <ul class="nav nav-banner">
    <li class="nav-item my-nav-item">
        <a class="nav-link
        my-nav-link
        head-text
        display-text
        nav-link-banner" aria-current="page" href="/posts">
            <h2 class="
            mb-0">
                posts
            </h2>
        </a>

    </li>

    <li class="nav-item my-nav-item">
        <a class="nav-link
        my-nav-link
        head-text
        display-text
        nav-link-banner" aria-current="page" href="/projects">
            <h2 class="
            mb-0">
                projects
            </h2>
        </a>
    </li>
    <li class="nav-item my-nav-item">
        <a class="nav-link
        my-nav-link
        head-text
        display-text
        nav-link-banner" aria-current="page" href="/photos">
            <h2 class="
            mb-0">
                photos
            </h2>
        </a>
    </li>
    <li class="nav-item my-nav-items">
        <a class="nav-link
        my-nav-link
        head-text
        display-text
        nav-link-banner" aria-current="page" href="/contacts">
            <h2 class="
            mb-0">
                contacts
            </h2>
        </a>
    </li>
</ul>
            </div>


        </div>


    </div>
</header>

<main class="container my-3 px-3">
    <div class="row">
        <div class="col-12 col-md-8 mb-3 mb-md-0">
            <p class="subway-blue">
                posted on January 17, 2023,
                last updated on Saturday, August 10, 2024 at 06:15 AM
            </p>
            <h3 id="1-printing-on-the-screen">1. Printing on the Screen</h3>

<p>Program using Relative Addressing technique</p>

<p><code>src/task1/print_rel.asm</code></p>

<div class="language-assembly highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>[SECTION .text]
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>global _start
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>_start:
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>        jmp saveme                        ; (complete)        jump to the call instruction that right
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>                                                                        ;                                                        before the &quot;Hello, world!&quot; string
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>shellcode:
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>                                pop esi                                        ; (complete)        pop the top value of stack (address of
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>                                                                                                ;                                                        msg) and save to esi register
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>                                                                                                
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>        mov eax, 4                  ; (complete)        opcode for write system call
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>        mov ebx, 1                  ; (complete)        1st arg is the fd (1 = STDOUT)
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>        mov ecx, esi          ; (complete)        2nd arg is the string address
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>        mov edx, 15           ; 3rd arg is len
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>        int 0x80              ; system call interrupt
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>        mov eax, 1            ; opcode for exit system call
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>        mov ebx, 0            ; 1st arg, exit(0)
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>        int 0x80              ; system call interrupt
<span class="line-numbers"><a href="#n19" name="n19">19</a></span> saveme:
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>        call shellcode        ; (complete)        jump back to the 1st instruction after jmp
<span class="line-numbers"><a href="#n21" name="n21">21</a></span>                                                                        ;                                                        instruction, and save the address of 
<span class="line-numbers"><a href="#n22" name="n22">22</a></span>                                                                        ;                                                        msg on the top of stack
<span class="line-numbers"><a href="#n23" name="n23">23</a></span>        msg db &quot;Hello, world!&quot;, 0xA, 0xD
</pre></div>
</div>
</div>

<p><img src="/assets/screenshots/1-1-rel.png" alt="1-1-rel" /></p>

<p>Program using Stack methods</p>

<p><code>src/task1/print_stk.asm</code></p>

<div class="language-assembly highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>[SECTION .text]
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>global _start
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>_start:
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>        mov eax, 0
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>        push eax
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>        push 0x000a0d21        ; hex format of &quot;!\r\n\0&quot;
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>        push &quot;orld&quot;
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>        push &quot;o, w&quot;                        ; (complete)        push &quot;o, w&quot; to stack
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>        push &quot;Hell&quot;                        ; (complete)        push &quot;Hell&quot; to stack
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>        mov eax, 4                        ; (complete)        opcode for write system call
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>        mov ebx, 1                        ; (complete)        1st arg is the fd (1 = STDOUT)
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>        mov ecx, esp                ; (complete)        2nd arg is the string address (stack top)
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>                                mov edx, 15                        ; 3rd arg, len
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>        int 0x80                                ; system call interrupt
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>        mov eax, 1                        ; opcode for exit system call
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>        mov ebx, 0                        ; 1st arg, exit(0)
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>        int 0x80                                ; system call interrupt
</pre></div>
</div>
</div>

<p><img src="/assets/screenshots/1-2-stk.png" alt="1-2-stk" /></p>

<blockquote>
  <p><em>(a) In <code>print_stk.asm</code>, explain how the line “<code>push 0x000a0d21</code>” works. Show a screenshot from gdb to support your explanation.</em></p>
</blockquote>

<p>From the gdb disassembler, the line <code>push 0x000a0d21</code> is located in memory at <code>0x08048066</code>.</p>

<p><img src="/assets/screenshots/1-1-1-disassembler.png" alt="1-1-1-disassembler" /></p>

<p>I set a breakpoint at <code>_start</code> and used <code>si</code> command to execute one instruction each time. When the program is running before executing the instruction of <code>push 0x000a0d21</code>, from the status of all registers,</p>

<p><img src="/assets/screenshots/1-1-2-registers-before.png" alt="1-1-2-registers-before" /></p>

<p>we can see that the current stack top address in memory is <code>0xbffff5fc</code>, and the value inside is <code>0x0</code>.</p>

<p>Then, after running the <code>push 0x000a0d21</code> instruction. From the register info, we can see that the value <code>0x000a0d21</code> is pushed into stack and the value of register <code>esp</code> has changed to <code>0xbffff5f8</code> (deduced 4), pointing to address of the top of stack.</p>

<p><img src="/assets/screenshots/1-1-3-registers-after.png" alt="1-1-3-registers-after" /></p>

<blockquote>
  <p><em>(b) Also, in the same file, explain how you got the string address. Show a screenshot from gdb to support your explanation.</em></p>
</blockquote>

<p>I used instruction <code>mov ecx, esp</code> to get the string address where it sets <code>ecx</code> register to the value inside <code>esp</code>. The <code>esp</code> register keeps the address of the stack top which points to one segment of the string <code>Hello, world!\r\n</code>.</p>

<p>By executing instructions one by one, from gdb, we can see that after <code>mov ecx, esp</code> is executed, the <code>ecx</code> register holds the address points to the string. Then, the system call <code>write</code> can use the string address as second argument.</p>

<p><img src="/assets/screenshots/1-2-1-register-after.png" alt="1-2-1-register-after" /></p>

<hr />

<h3 id="2-spawning-a-shell">2. Spawning a Shell</h3>

<h4 id="21-startup-code-labshasm">2.1 Startup Code (labsh.asm)</h4>

<blockquote>
  <ol>
    <li><em>The process number of both the calling shell and the spawned shell using “<code>echo $$</code>”.</em></li>
  </ol>
</blockquote>

<p><img src="/assets/screenshots/2-1-1.png" alt="2-1-1" /></p>

<blockquote>
  <ol>
    <li><em>The passed environment variables to the spawned shell using “<code>/usr/bin/env</code>”</em></li>
  </ol>
</blockquote>

<p><img src="/assets/screenshots/2-1-2-usr-bin-env.png" alt="2-1-2-usr-bin-env" /></p>

<h4 id="22-providing-arguments-to-binsh">2.2 Providing Arguments to <code>/bin/sh</code></h4>

<p>I constructed the argument string “<code>-c</code>” and “<code>ls -la</code>” by pushing them into stack and use <code>esi</code> register to keep their address in memory. When constructing <code>argv</code>, I pushed the address of each argument string into the stack to form an array of strings.</p>

<p><code>src/task2/labsh_args.asm</code></p>

<div class="language-assembly highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>section .text
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>  global _start
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>    _start:
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>      mov  eax, 0
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>      push eax          ; Use 0 to terminate the string
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>      push &quot;//sh&quot;
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>      push &quot;/bin&quot;
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>      mov  ebx, esp     ; Get the string address of &quot;/bin//sh&quot;
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>      ; push &quot;-c&quot; and &quot;ls -la&quot; into stack
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>      push eax
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>      push &quot;-c&quot;
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>      push eax
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>      push &quot;la&quot;
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>      push &quot;ls -&quot;
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>      mov esi, esp                        ; Keep the current stack top address to esi register
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>      
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>      ; Construct the argument array argv[]
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>      push eax                                        ; argv[3] = 0, EOL
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>      push esi                                        ; argv[2] points to &quot;ls -la&quot;
<span class="line-numbers"><a href="#n21" name="n21">21</a></span>      add esi, 12                                ; move the esi register to point to &quot;-c&quot;
<span class="line-numbers"><a href="#n22" name="n22">22</a></span>      push esi                                        ; argv[1] points to &quot;-c&quot;
<span class="line-numbers"><a href="#n23" name="n23">23</a></span>      add esi, 20                                ; move the esi register to point to &quot;/bin//sh&quot;
<span class="line-numbers"><a href="#n24" name="n24">24</a></span>      push esi                                        ; argv[0] points to &quot;/bin//sh&quot;
<span class="line-numbers"><a href="#n25" name="n25">25</a></span>      mov  ecx, esp     ; Get the address of argv[]
<span class="line-numbers"><a href="#n26" name="n26">26</a></span>
<span class="line-numbers"><a href="#n27" name="n27">27</a></span>      ; For environment variable 
<span class="line-numbers"><a href="#n28" name="n28">28</a></span>      mov edx, 0                     ; No env variables 
<span class="line-numbers"><a href="#n29" name="n29">29</a></span>
<span class="line-numbers"><strong><a href="#n30" name="n30">30</a></strong></span>      ; Call execve()
<span class="line-numbers"><a href="#n31" name="n31">31</a></span>      mov  eax, 0             ; eax = 0x00000000
<span class="line-numbers"><a href="#n32" name="n32">32</a></span>      mov  al, 0x0b            ; eax = 0x0000000b
<span class="line-numbers"><a href="#n33" name="n33">33</a></span>      int  0x80
</pre></div>
</div>
</div>

<p><img src="/assets/screenshots/2-2-1-result.png" alt="2-2-1-result" /></p>

<h4 id="23-providing-env-variable-to-binsh">2.3 Providing Env. Variable to <code>/bin/sh</code></h4>

<p>I constructed environment variable strings by pushing them into stack and use <code>esi</code> register to keep their address in memory as in the 2.2. When constructing <code>envp</code>, I pushed the address of each envrionment variable string into the stack to form an array of strings.</p>

<p><code>src/task2/labsh_env.asm</code></p>

<div class="language-assembly highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>section .text
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>  global _start
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>    _start:
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>      ; Store the argument string on stack
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>      mov          eax, 0
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>      push         eax                                        ; Use 0 to terminate the string
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>      push         &quot;//sh&quot;
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>      push         &quot;/bin&quot;
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>      mov          ebx, esp                ; Get the string address
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>                        ; Construct the argument array argv[] = { NULL }
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>      mov         ecx, eax
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>                         
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>                        ; Construct the envrionment variable strings
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>      push         eax
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>      push         &quot;4&quot;
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>      push         &quot;=123&quot;
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>      push         &quot;aaaa&quot;
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>      push         eax
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>      push         &quot;8&quot;
<span class="line-numbers"><a href="#n21" name="n21">21</a></span>      push         &quot;=567&quot;
<span class="line-numbers"><a href="#n22" name="n22">22</a></span>      push         &quot;bbbb&quot;
<span class="line-numbers"><a href="#n23" name="n23">23</a></span>      push         eax
<span class="line-numbers"><a href="#n24" name="n24">24</a></span>      push         &quot;4&quot;
<span class="line-numbers"><a href="#n25" name="n25">25</a></span>      push         &quot;=123&quot;
<span class="line-numbers"><a href="#n26" name="n26">26</a></span>      push         &quot;cccc&quot;
<span class="line-numbers"><a href="#n27" name="n27">27</a></span>      mov         esi, esp        ; Save the address of stack top to esi
<span class="line-numbers"><a href="#n28" name="n28">28</a></span>      
<span class="line-numbers"><a href="#n29" name="n29">29</a></span>      ; Construct the environment array envp[]
<span class="line-numbers"><strong><a href="#n30" name="n30">30</a></strong></span>      push         eax                                ; envp[3] = 0, EOL
<span class="line-numbers"><a href="#n31" name="n31">31</a></span>      push         esi                                ; envp[2] points to &quot;cccc=1234&quot;
<span class="line-numbers"><a href="#n32" name="n32">32</a></span>      add         esi, 16         ; move the esi to point to next string
<span class="line-numbers"><a href="#n33" name="n33">33</a></span>      push         esi                                ; envp[1] points to &quot;bbbb=5678&quot;
<span class="line-numbers"><a href="#n34" name="n34">34</a></span>      add         esi, 16         ; move the esi to point to next string
<span class="line-numbers"><a href="#n35" name="n35">35</a></span>      push         esi                                ; envp[0] points to &quot;aaaa=1234&quot;
<span class="line-numbers"><a href="#n36" name="n36">36</a></span>      mov          edx, esp        ; Get the address of envp[]
<span class="line-numbers"><a href="#n37" name="n37">37</a></span>
<span class="line-numbers"><a href="#n38" name="n38">38</a></span>      ; Call execve()
<span class="line-numbers"><a href="#n39" name="n39">39</a></span>      mov          eax, 0                ; eax = 0x00000000
<span class="line-numbers"><strong><a href="#n40" name="n40">40</a></strong></span>      mov          al, 0x0b        ; eax = 0x0000000b
<span class="line-numbers"><a href="#n41" name="n41">41</a></span>      int          0x80
</pre></div>
</div>
</div>

<p><img src="/assets/screenshots/2-3-1-result.png" alt="2-3-1-result" /></p>

<h4 id="24-using-the-relative-addressing-technique">2.4 Using the Relative Addressing Technique</h4>

<p>First, the program jumps to a <code>call</code> instruction at line 19, right before the the string.</p>

<p><img src="/assets/screenshots/2-4-2-start.png" alt="2-4-2-start" /></p>

<p>Then, the program executes the <code>call</code> instruction and jumps back to the instruction after the previous <code>jmp</code> instruction, and push the address of the string <code>/bin/sh*AAAABBBB</code> into stack.</p>

<p><img src="/assets/screenshots/2-4-3-one.png" alt="2-4-3-one" /></p>

<p>Now, The stack top contains the address of the string:</p>

<p><img src="/assets/screenshots/2-4-4-stack-top.png" alt="2-4-4-stack-top" /></p>

<p>The program will pop the string address and save to <code>esi</code> register after the instruction <code>pop esi</code>. <code>esi</code> register now holds the address of the string.</p>

<p><img src="/assets/screenshots/2-4-5-esi-holds-string-addr.png" alt="2-4-5-esi-holds-string-addr" /></p>

<p>Then, the program copys the string address to <code>ebx</code> register, ready to be used as first argument of <code>execve </code> system call.</p>

<p>The first 7 characters in the string contains the filename of the shell program we want to run in the shellcode. To construct the filename string, the program rewrites the memory at <code>[ebx+7]</code> with <code>\0</code> to terminate the filename string.</p>

<p><img src="/assets/screenshots/2-4-6-turncate-string.png" alt="2-4-6-turncate-string" /></p>

<p>Next, the program saves the address of string <code>/bin/sh</code> to the memory at <code>[ebx+8]</code>, ready to construct the <code>argv</code> array.</p>

<p><img src="/assets/screenshots/2-4-7-argv.png" alt="2-4-7-argv" /></p>

<p>The program terminate the <code>argv</code> array with <code>0</code> at <code>[ebx+12]</code> and assigns the <code>ecx</code> register with the <code>argv</code> array.</p>

<p><img src="/assets/screenshots/2-4-8-argv-array.png" alt="2-4-8-argv-array" /></p>

<p>The program save <code>0</code> to <code>edx</code> for no environment variable is passed to the shell program.</p>

<p><img src="/assets/screenshots/2-4-9-no-envp.png" alt="2-4-9-no-envp" /></p>

<p>In the last, the program save <code>0x0b</code> to <code>eax</code> and invokes a system call interrupt to spawn a shell.</p>

<p><img src="/assets/screenshots/2-4-10-sh.png" alt="2-4-10-sh" /></p>

<p><code>src/task2/labsh_rel.asm</code></p>

<div class="language-assembly highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>section .text
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>global _start
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>_start:
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>              jmp two
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>one:
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>                                pop esi
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>        mov ebx, esi                                                 ; (complete) ebx should contain the string address
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>                                mov eax, 0
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>        mov byte [ebx+7], 0x00  ; (complete) terminate /bin/sh with 0x00 (1 byte)
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>        mov [ebx+8], ebx                           ; (complete) save ebx to memory at addressebx+8, points to &quot;/bin/sh&quot; saved at $ebx
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>        mov [ebx+12], eax                          ; (complete) save eax to memory at address ebx+12, terminates the argv[]
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>        lea ecx, [ebx+8]                           ; let ecx = ebx + 8
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>        
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>                                mov edx, 0
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>        mov al, 0x0b
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>        int 0x80
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>                                ;        execve(&quot;/bin/sh&quot;, [&quot;/bin/sh&quot;], NULL)
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>two:
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>        call one
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>        db &quot;/bin/sh*AAAABBBB&quot;                ; &quot;/bin/sh&quot; and remaining characters as placeholder
</pre></div>
</div>
</div>

<p>Since this program is required for writable code segment, to produce a executable binary file for this program, we need to use the <code>--omagic</code> flag to enable <code>ld</code> to do so.</p>

<div class="language-shell highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>nasm -f elf32 ./src/task2/labsh.rel.asm
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>ld --omagic ./src/task2/labsh_rel.o -o labsh_rel
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>./labsh_rel
</pre></div>
</div>
</div>


        </div>
        
        <div class="col-12 col-md-4">
            
            <h2>Table of Content</h2>
            
            <ul id="toc" class="toc-list">
<li class="toc-item toc-h3"><a href="#1-printing-on-the-screen">1. Printing on the Screen</a></li>
<li class="toc-item toc-h3"><a href="#2-spawning-a-shell">2. Spawning a Shell</a></li>
</ul>
            <div class="card my-card">
  <div class="card-header my-card-header">
    <h4 class="mb-0 display-text">Recent posts</h2>
  </div>
  <ul class="list-group list-group-flush">
    
    <a class="list-group-item my-list-group-item" href="/2024/07/27/canada-pr-application.html">
      <div class="row">
        <div class="col">
          <strong>Canada PR application (after provincial nomination)</strong>
        </div>
      </div>
      <div class="row">
        <div class="col">
          created at July 27, 2024,
          last updated on August 10, 2024
        </div>
        <div class="col-auto">
          
        </div>
      </div>
    </a>
    
    <a class="list-group-item my-list-group-item" href="/2024/07/22/angular-notes.html">
      <div class="row">
        <div class="col">
          <strong>Angular Notes</strong>
        </div>
      </div>
      <div class="row">
        <div class="col">
          created at July 22, 2024,
          last updated on August 10, 2024
        </div>
        <div class="col-auto">
          
        </div>
      </div>
    </a>
    
    <a class="list-group-item my-list-group-item" href="/2024/07/16/configure-a-ts-project.html">
      <div class="row">
        <div class="col">
          <strong>Configure a TypeScript project with CI/CD</strong>
        </div>
      </div>
      <div class="row">
        <div class="col">
          created at July 16, 2024,
          last updated on August 10, 2024
        </div>
        <div class="col-auto">
          
        </div>
      </div>
    </a>
    
    <a class="list-group-item my-list-group-item" href="/2024/07/09/leetcode-notes.html">
      <div class="row">
        <div class="col">
          <strong>Leetcode Notes</strong>
        </div>
      </div>
      <div class="row">
        <div class="col">
          created at July 09, 2024,
          last updated on August 10, 2024
        </div>
        <div class="col-auto">
          
        </div>
      </div>
    </a>
    
    <a class="list-group-item my-list-group-item" href="/2024/07/09/azure-500-notes.html">
      <div class="row">
        <div class="col">
          <strong>AZ-500 notes</strong>
        </div>
      </div>
      <div class="row">
        <div class="col">
          created at July 09, 2024,
          last updated on August 10, 2024
        </div>
        <div class="col-auto">
          
        </div>
      </div>
    </a>
    
  </ul>
</div> 
        </div>

    </div>
</main>

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
    integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
    crossorigin="anonymous"></script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
</script>

</html>